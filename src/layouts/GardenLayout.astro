---
import '../styles/tailwind.css';
import { Fragment } from 'astro/jsx-runtime';
import GardenHeader from '../components/GardenHeader.astro';
import SearchBox from '../components/SearchBox.astro';

interface Breadcrumb {
  label: string;
  href?: string;
}

const { title = 'Lucas’s Mind Garden', breadcrumbs = [] } = Astro.props as {
  title?: string;
  breadcrumbs?: Breadcrumb[];
};
---
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title} · Lucas’s Mind Garden</title>
    <meta name="theme-color" content="#f5f7ff" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Source+Serif+4:opsz,wght@8..60,400;8..60,500;8..60,600&display=swap" rel="stylesheet" />
    <script is:inline>
      const storageKey = 'lucas-theme';
      const stored = (() => {
        try { return localStorage.getItem(storageKey); } catch (error) { return null; }
      })();
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const theme = stored ?? (systemDark ? 'dark' : 'light');
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
        document.documentElement.setAttribute('data-theme', 'dark');
      } else {
        document.documentElement.classList.remove('dark');
        document.documentElement.setAttribute('data-theme', 'light');
      }
    </script>
  </head>
  <body class="bg-neutral-50 text-neutral-900 antialiased transition-colors dark:bg-neutral-950 dark:text-neutral-100">
    <GardenHeader breadcrumbs={breadcrumbs}>
      {Astro.slots.has('search') ? (
        <Fragment slot="search">
          <slot name="search" />
        </Fragment>
      ) : (
        <Fragment slot="search">
          <SearchBox />
        </Fragment>
      )}
      {Astro.slots.has('actions') && (
        <Fragment slot="actions">
          <slot name="actions" />
        </Fragment>
      )}
    </GardenHeader>
    <main class="mx-auto w-full max-w-5xl px-4 py-10 lg:px-6">
      <slot />
    </main>
    <footer class="mx-auto max-w-5xl px-4 pb-10 text-sm text-neutral-500 dark:text-neutral-400">
      <p>
        Cultivated with curiosity. Built with Astro, Tailwind, and love. <a class="underline-offset-4 hover:underline" href="/">Return to landing</a>.
      </p>
    </footer>
  </body>
</html>
